{"version":3,"file":"index.js","sources":["../src/search.js"],"sourcesContent":["import iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\nconst form = document.getElementById('search-form');\r\nconst gallery = document.querySelector('.gallery');\r\nconst loader = document.querySelector('.loader');\r\nconst loadingText = document.querySelector('.loading-text');\r\n\r\nconst BASE_URL = 'https://pixabay.com/api/';\r\nconst API_KEY = '51573192-1104e7b47bcf1a597d33c16a5';\r\n\r\nconst lightbox = new SimpleLightbox('.gallery a');\r\n\r\n// Sayfa yüklendiğinde URL'deki query'yi form alanına yaz\r\nwindow.addEventListener('DOMContentLoaded', () => {\r\n  const params = new URLSearchParams(window.location.search);\r\n  const query = params.get('query');\r\n  if (query) {\r\n    form.searchQuery.value = query;\r\n    performSearch(query); // sayfa yüklenince otomatik arama yapar\r\n  }\r\n});\r\n\r\nform.addEventListener('submit', async event => {\r\n  event.preventDefault();\r\n  const query = form.searchQuery.value.trim();\r\n  if (!query) return;\r\n  updateQueryParam(query); // URL'yi güncelle\r\n  performSearch(query);\r\n});\r\n\r\nfunction updateQueryParam(query) {\r\n  const newUrl = `${window.location.pathname}?query=${encodeURIComponent(query)}`;\r\n  window.history.pushState({ path: newUrl }, '', newUrl);\r\n}\r\n\r\nasync function performSearch(query) {\r\n  gallery.innerHTML = '';\r\n  gallery.style.display = 'none';\r\n  loader.hidden = false;\r\n  loadingText.hidden = false;\r\n\r\n  try {\r\n    const data = await fetchImages(query);\r\n\r\n    if (data.hits.length === 0) {\r\n      iziToast.warning({\r\n        class: 'my-warning-toast',\r\n        message: 'Sorry, no images match your search. Please try again!',\r\n        position: 'topRight',\r\n      });\r\n      hideLoading();\r\n      return;\r\n    }\r\n\r\n    renderGallery(data.hits);\r\n  } catch (error) {\r\n    iziToast.error({\r\n      message: 'Something went wrong. Please try again later.',\r\n      position: 'topRight',\r\n    });\r\n    hideLoading();\r\n  }\r\n}\r\n\r\nfunction hideLoading() {\r\n  loader.hidden = true;\r\n  loadingText.hidden = true;\r\n  gallery.style.display = 'grid';\r\n}\r\n\r\nfunction fetchImages(query) {\r\n  const params = new URLSearchParams({\r\n    key: API_KEY,\r\n    q: query,\r\n    image_type: 'photo',\r\n    orientation: 'horizontal',\r\n    safesearch: 'true',\r\n  });\r\n\r\n  return fetch(`${BASE_URL}?${params}`).then(response => {\r\n    if (!response.ok) {\r\n      throw new Error('Fetch failed');\r\n    }\r\n    return response.json();\r\n  });\r\n}\r\n\r\nfunction renderGallery(images) {\r\n  const markup = images\r\n    .map(image => `\r\n      <li class=\"gallery-item\">\r\n        <div class=\"photo-card\">\r\n          <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\r\n            <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\r\n          </a>\r\n          <div class=\"info\">\r\n            <div class=\"info-column\">\r\n              <span class=\"info-label\">Likes</span>\r\n              <span class=\"info-value\">${image.likes}</span>\r\n            </div>\r\n            <div class=\"info-column\">\r\n              <span class=\"info-label\">Views</span>\r\n              <span class=\"info-value\">${image.views}</span>\r\n            </div>\r\n            <div class=\"info-column\">\r\n              <span class=\"info-label\">Comments</span>\r\n              <span class=\"info-value\">${image.comments}</span>\r\n            </div>\r\n            <div class=\"info-column\">\r\n              <span class=\"info-label\">Downloads</span>\r\n              <span class=\"info-value\">${image.downloads}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </li>\r\n    `)\r\n    .join('');\r\n\r\n  gallery.insertAdjacentHTML('beforeend', markup);\r\n\r\n  const imagesOnPage = gallery.querySelectorAll('img.gallery-image');\r\n  let loadedCount = 0;\r\n\r\n  if (imagesOnPage.length === 0) {\r\n    hideLoading();\r\n    lightbox.refresh();\r\n    return;\r\n  }\r\n\r\n  imagesOnPage.forEach(img => {\r\n    if (img.complete) {\r\n      incrementCounter();\r\n    } else {\r\n      img.addEventListener('load', incrementCounter);\r\n      img.addEventListener('error', incrementCounter);\r\n    }\r\n  });\r\n\r\n  function incrementCounter() {\r\n    loadedCount++;\r\n    if (loadedCount === imagesOnPage.length) {\r\n      hideLoading();\r\n      lightbox.refresh();\r\n    }\r\n  }\r\n}\r\n"],"names":["form","gallery","loader","loadingText","BASE_URL","API_KEY","lightbox","SimpleLightbox","query","performSearch","event","updateQueryParam","newUrl","data","fetchImages","iziToast","hideLoading","renderGallery","params","response","images","markup","image","imagesOnPage","loadedCount","img","incrementCounter"],"mappings":"6vBAMA,MAAMA,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,eAAe,EAEpDC,EAAW,2BACXC,EAAU,qCAEVC,EAAW,IAAIC,EAAe,YAAY,EAGhD,OAAO,iBAAiB,mBAAoB,IAAM,CAEhD,MAAMC,EADS,IAAI,gBAAgB,OAAO,SAAS,MAAM,EACpC,IAAI,OAAO,EAC5BA,IACFR,EAAK,YAAY,MAAQQ,EACzBC,EAAcD,CAAK,EAEvB,CAAC,EAEDR,EAAK,iBAAiB,SAAU,MAAMU,GAAS,CAC7CA,EAAM,eAAc,EACpB,MAAMF,EAAQR,EAAK,YAAY,MAAM,KAAI,EACpCQ,IACLG,EAAiBH,CAAK,EACtBC,EAAcD,CAAK,EACrB,CAAC,EAED,SAASG,EAAiBH,EAAO,CAC/B,MAAMI,EAAS,GAAG,OAAO,SAAS,QAAQ,UAAU,mBAAmBJ,CAAK,CAAC,GAC7E,OAAO,QAAQ,UAAU,CAAE,KAAMI,GAAU,GAAIA,CAAM,CACvD,CAEA,eAAeH,EAAcD,EAAO,CAClCP,EAAQ,UAAY,GACpBA,EAAQ,MAAM,QAAU,OACxBC,EAAO,OAAS,GAChBC,EAAY,OAAS,GAErB,GAAI,CACF,MAAMU,EAAO,MAAMC,EAAYN,CAAK,EAEpC,GAAIK,EAAK,KAAK,SAAW,EAAG,CAC1BE,EAAS,QAAQ,CACf,MAAO,mBACP,QAAS,wDACT,SAAU,UAClB,CAAO,EACDC,IACA,MACD,CAEDC,EAAcJ,EAAK,IAAI,CACxB,MAAe,CACdE,EAAS,MAAM,CACb,QAAS,gDACT,SAAU,UAChB,CAAK,EACDC,GACD,CACH,CAEA,SAASA,GAAc,CACrBd,EAAO,OAAS,GAChBC,EAAY,OAAS,GACrBF,EAAQ,MAAM,QAAU,MAC1B,CAEA,SAASa,EAAYN,EAAO,CAC1B,MAAMU,EAAS,IAAI,gBAAgB,CACjC,IAAKb,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,MAChB,CAAG,EAED,OAAO,MAAM,GAAGJ,CAAQ,IAAIc,CAAM,EAAE,EAAE,KAAKC,GAAY,CACrD,GAAI,CAACA,EAAS,GACZ,MAAM,IAAI,MAAM,cAAc,EAEhC,OAAOA,EAAS,MACpB,CAAG,CACH,CAEA,SAASF,EAAcG,EAAQ,CAC7B,MAAMC,EAASD,EACZ,IAAIE,GAAS;AAAA;AAAA;AAAA,0CAGwBA,EAAM,aAAa;AAAA,8CACfA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,yCAK3CA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,yCAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,yCAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,yCAIdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,KAKnD,EACA,KAAK,EAAE,EAEVrB,EAAQ,mBAAmB,YAAaoB,CAAM,EAE9C,MAAME,EAAetB,EAAQ,iBAAiB,mBAAmB,EACjE,IAAIuB,EAAc,EAElB,GAAID,EAAa,SAAW,EAAG,CAC7BP,IACAV,EAAS,QAAO,EAChB,MACD,CAEDiB,EAAa,QAAQE,GAAO,CACtBA,EAAI,SACNC,KAEAD,EAAI,iBAAiB,OAAQC,CAAgB,EAC7CD,EAAI,iBAAiB,QAASC,CAAgB,EAEpD,CAAG,EAED,SAASA,GAAmB,CAC1BF,IACIA,IAAgBD,EAAa,SAC/BP,IACAV,EAAS,QAAO,EAEnB,CACH"}